# AI教案生成系统重构设计

## 背景与问题

### 现状分析

当前AI教案生成功能存在以下核心问题:

1. 生成内容质量低,模板化严重,缺少个性化定制
2. 缺少可视化在线编辑能力,编辑体验极差
3. 生成流程冗长,用户体验不够流畅
4. 功能不完善,缺少添加到列表、导出文档等关键功能
5. 内容展示单一,没有实时预览和多样化呈现

### 设计目标

1. 提供高质量、个性化的AI教案生成能力
2. 支持可视化在线编辑,所见即所得
3. 简化生成流程,提升用户体验
4. 完善导出功能,支持Word/PPT一键导出
5. 支持教案列表管理,方便组织和复用

## 功能设计

### 1. 教案生成流程优化

#### 1.1 生成步骤简化

将原有的4步流程优化为更加高效的3步:

**步骤一: 基础配置**
- 教案标题(必填)
- 课程信息:课程名称、授课教师、学生人数、课时
- 快捷选择:支持从学习路径快速创建教案

**步骤二: 智能配置**
- 知识点选择:
  - 支持多选知识点
  - 提供知识点搜索和分类筛选(基础/进阶/高级)
  - 显示已选知识点预览
  - AI推荐相关知识点
- 教学配置:
  - 难度级别(简单/中等/困难)
  - 教学风格(视觉型/学术型/逻辑型)
  - 课堂形式(讲授式/讨论式/实验式/混合式)
  - 学生基础水平(待评估/薄弱/中等/良好/优秀)

**步骤三: AI生成与编辑**
- AI实时生成教案内容
- 可视化在线编辑器
- 实时预览与调整
- 一键导出功能

#### 1.2 智能生成引擎升级

**生成内容结构**

教案应包含以下核心模块:

1. 基本信息
   - 教案标题
   - 课程名称
   - 授课教师
   - 授课班级与人数
   - 课时安排
   - 教学日期

2. 教学目标
   - 知识与技能目标:根据选择的知识点和难度级别智能生成
   - 过程与方法目标:根据教学风格和课堂形式定制
   - 情感态度与价值观目标:结合学科特点生成

3. 教学重难点
   - 教学重点:从选择的知识点中提取核心概念
   - 教学难点:分析知识点难度和学生基础水平,智能识别
   - 突破策略:针对难点提供具体的教学策略

4. 教学准备
   - 教师准备:教学课件、教学工具、案例素材
   - 学生准备:预习要求、材料准备
   - 环境准备:教室布置、设备调试

5. 教学过程设计
   - 导入环节(时长、活动内容、设计意图)
   - 讲授环节(知识点讲解、例题演示、互动问答)
   - 练习环节(练习设计、分组活动、巡视指导)
   - 总结环节(知识回顾、作业布置、预告下节)
   - 每个环节包含:时间分配、教学活动、教师行为、学生活动、设计意图

6. 课堂活动设计
   - 根据教学风格设计互动活动
   - 活动类型:小组讨论/案例分析/实验演示/角色扮演/游戏化学习
   - 活动步骤、时间分配、预期效果

7. 板书设计
   - 主标题
   - 知识框架图
   - 重点概念标注
   - 示例展示

8. 教学资源
   - 视频资源
   - 练习题库
   - 阅读材料
   - 工具软件
   - 参考案例

9. 作业设计
   - 基础巩固题
   - 拓展提高题
   - 实践应用题
   - 作业要求与提交方式

10. 教学评估
    - 评估方式:课堂问答/练习测验/小组评价/作业批改
    - 评估标准:优秀/良好/需改进的具体标准
    - 反馈机制:如何给学生反馈,如何调整教学

11. 教学反思预留
    - 教学效果评价
    - 学生反馈记录
    - 改进建议

**生成算法优化**

根据用户输入的配置参数,生成引擎应实现:

- 根据知识点难度智能匹配教学目标层次
- 根据学生基础水平调整教学深度和节奏
- 根据教学风格选择合适的活动类型和教学方法
- 根据课时长度合理分配各环节时间
- 自动关联知识点与教学资源库
- 生成符合学科特点的板书设计
- 提供差异化的作业设计

**个性化定制能力**

- 支持教师风格偏好记忆
- 支持历史教案模板复用
- 支持自定义教学环节
- 支持AI续写和扩展内容

### 2. 可视化编辑器设计

#### 2.1 编辑器功能需求

提供富文本编辑能力,支持:

**基础编辑功能**
- 文本格式:加粗、斜体、下划线、字号、字体、颜色
- 段落格式:标题层级、列表(有序/无序)、缩进、对齐
- 插入元素:表格、图片、链接、分隔线

**高级编辑功能**
- 模块化编辑:每个教案模块可独立编辑
- 拖拽排序:支持模块顺序调整
- 模板插入:快速插入预设的活动模板、板书模板
- AI辅助:选中内容可使用AI续写、润色、扩展

**实时预览**
- 左侧编辑,右侧实时预览
- 支持导出格式预览(Word/PPT样式)

#### 2.2 编辑器布局设计

采用分栏布局:

```
+------------------+------------------+
|   工具栏区域      |   操作按钮区      |
+------------------+------------------+
|                 |                  |
|   编辑区域        |   预览区域        |
| (左侧 60%)      | (右侧 40%)       |
|                 |                  |
|   - 模块列表     |   - 实时渲染     |
|   - 富文本编辑   |   - 样式预览     |
|                 |                  |
+------------------+------------------+
```

工具栏包含:
- 保存草稿
- 发布教案
- 导出Word
- 导出PPT
- 返回列表

### 3. 教案管理功能

#### 3.1 教案列表页

展示所有创建的教案,支持:

**列表展示**
- 教案标题
- 课程名称
- 创建时间
- 最后修改时间
- 状态(草稿/已发布)
- 版本号

**操作功能**
- 查看详情
- 编辑教案
- 复制教案(快速创建相似教案)
- 删除教案
- 导出Word/PPT
- 分享教案(生成分享链接)

**筛选与搜索**
- 按课程筛选
- 按状态筛选
- 按创建时间排序
- 关键词搜索

**批量操作**
- 批量删除
- 批量导出
- 批量修改状态

#### 3.2 教案详情页

只读查看模式,展示完整教案内容:

- 基本信息卡片
- 教案内容分模块展示
- 操作按钮:编辑、导出、分享、删除

### 4. 导出功能升级

#### 4.1 Word导出优化

**文档结构优化**
- 封面页:标题、课程信息、教师信息、日期
- 目录页:自动生成目录
- 正文:各模块按层级展示
- 页眉页脚:页码、教案标题、教师姓名

**排版优化**
- 统一字体和字号规范
- 合理的段落间距和行距
- 重点内容突出显示
- 表格边框和对齐
- 图片居中处理

**样式模板**
- 提供多种Word模板风格(正式/简约/学术/活泼)
- 支持用户自定义模板

#### 4.2 PPT导出优化

**幻灯片结构**
- 封面页:标题、副标题、教师信息
- 目录页:章节导航
- 内容页:每个模块生成对应幻灯片
- 结束页:感谢页

**设计优化**
- 提供多种PPT主题模板(经典商务/现代简约/学术风格/活力青春/科技未来)
- 统一配色方案
- 合理的文本布局和字号
- 图文混排
- 动画效果(可选)

**特色功能**
- 教学流程生成流程图幻灯片
- 板书设计生成可视化图示
- 自动提取要点生成项目符号列表

#### 4.3 PDF导出

支持将教案导出为PDF格式:
- 保持排版一致性
- 适合打印和分享
- 支持水印添加

### 5. AI功能增强

#### 5.1 智能推荐

**知识点推荐**
- 根据已选知识点,推荐相关或后续知识点
- 分析知识点依赖关系,提示前置知识

**资源推荐**
- 根据知识点自动匹配视频、练习、案例等资源
- 推荐优质教学案例

**教学策略推荐**
- 根据学生基础水平推荐合适的教学方法
- 根据知识点难度推荐突破策略

#### 5.2 AI辅助编辑

**内容生成**
- AI续写:基于上下文续写内容
- AI扩展:将简短内容扩展为详细描述
- AI润色:优化语言表达,使其更专业
- AI改写:换一种表达方式

**智能检查**
- 语法和错别字检查
- 逻辑连贯性检查
- 时间分配合理性检查
- 教学目标与内容匹配度检查

#### 5.3 智能分析

**教案质量评估**
- 内容完整性评分
- 结构合理性评分
- 难度适配度评分
- 给出改进建议

**教学效果预测**
- 根据教案内容预测学生接受度
- 预估知识点掌握情况
- 提供优化建议

### 6. 模板库功能

#### 6.1 官方模板

提供不同学科、不同课型的官方教案模板:
- 新课教学模板
- 复习课模板
- 实验课模板
- 讨论课模板

每个模板包含:
- 模板预览
- 适用场景说明
- 使用次数统计

#### 6.2 个人模板

支持教师保存和复用个人模板:
- 基于现有教案创建模板
- 管理个人模板库
- 快速应用模板

#### 6.3 协作与分享

- 分享教案给其他教师
- 查看和使用其他教师分享的优质教案
- 教案评分和评论

## 数据模型设计

### 教案数据结构

教案对象应包含以下字段:

| 字段名 | 类型 | 说明 |
|--------|------|------|
| id | String | 教案唯一标识 |
| title | String | 教案标题 |
| courseId | String | 课程ID |
| courseName | String | 课程名称 |
| knowledgePointIds | Array | 关联知识点ID列表 |
| version | Number | 版本号 |
| status | String | 状态(draft/published) |
| metadata | Object | 元数据信息 |
| metadata.author | String | 作者 |
| metadata.studentCount | Number | 学生人数 |
| metadata.duration | Number | 课时(分钟) |
| metadata.difficulty | String | 难度(simple/medium/hard) |
| metadata.teachingStyle | String | 教学风格 |
| metadata.classFormat | String | 课堂形式 |
| metadata.studentLevel | String | 学生基础水平 |
| metadata.createdAt | DateTime | 创建时间 |
| metadata.updatedAt | DateTime | 更新时间 |
| metadata.publishedAt | DateTime | 发布时间 |
| basicInfo | Object | 基本信息 |
| basicInfo.className | String | 班级 |
| basicInfo.teachingDate | Date | 授课日期 |
| teachingGoals | Array | 教学目标 |
| teachingGoals[].type | String | 目标类型(knowledge/process/emotion) |
| teachingGoals[].content | String | 目标内容 |
| keyPoints | Object | 教学重难点 |
| keyPoints.highlights | Array | 教学重点 |
| keyPoints.difficulties | Array | 教学难点 |
| keyPoints.strategies | Array | 突破策略 |
| preparation | Object | 教学准备 |
| preparation.teacher | Array | 教师准备 |
| preparation.student | Array | 学生准备 |
| preparation.environment | Array | 环境准备 |
| teachingFlow | Array | 教学过程 |
| teachingFlow[].phase | String | 环节名称 |
| teachingFlow[].duration | Number | 时长(分钟) |
| teachingFlow[].teacherActivities | Array | 教师活动 |
| teachingFlow[].studentActivities | Array | 学生活动 |
| teachingFlow[].designIntent | String | 设计意图 |
| activities | Array | 课堂活动 |
| activities[].type | String | 活动类型 |
| activities[].time | Number | 活动时长 |
| activities[].steps | Array | 活动步骤 |
| activities[].expectedOutcome | String | 预期效果 |
| boardDesign | Object | 板书设计 |
| boardDesign.title | String | 板书标题 |
| boardDesign.framework | Array | 知识框架 |
| boardDesign.keyPoints | Array | 重点标注 |
| boardDesign.examples | Array | 示例展示 |
| resources | Array | 教学资源 |
| resources[].type | String | 资源类型 |
| resources[].name | String | 资源名称 |
| resources[].url | String | 资源链接 |
| resources[].description | String | 资源描述 |
| homework | Object | 作业设计 |
| homework.basic | Array | 基础题 |
| homework.extended | Array | 拓展题 |
| homework.practical | Array | 实践题 |
| homework.requirements | String | 作业要求 |
| homework.submission | String | 提交方式 |
| assessment | Object | 教学评估 |
| assessment.methods | Array | 评估方式 |
| assessment.criteria | Object | 评估标准 |
| assessment.criteria.excellent | String | 优秀标准 |
| assessment.criteria.good | String | 良好标准 |
| assessment.criteria.needImprovement | String | 需改进标准 |
| assessment.feedbackMechanism | String | 反馈机制 |
| reflection | Object | 教学反思 |
| reflection.effectiveness | String | 效果评价 |
| reflection.studentFeedback | String | 学生反馈 |
| reflection.improvements | String | 改进建议 |
| content | String | 完整HTML内容(用于预览和编辑) |
| shareToken | String | 分享令牌 |
| templateId | String | 关联模板ID |

### 模板数据结构

| 字段名 | 类型 | 说明 |
|--------|------|------|
| id | String | 模板ID |
| name | String | 模板名称 |
| type | String | 模板类型(official/personal) |
| category | String | 模板分类(新课/复习/实验/讨论) |
| subject | String | 适用学科 |
| description | String | 模板描述 |
| thumbnail | String | 缩略图 |
| structure | Object | 模板结构(包含各模块配置) |
| usageCount | Number | 使用次数 |
| authorId | String | 创建者ID(个人模板) |
| createdAt | DateTime | 创建时间 |

## 交互流程设计

### 教案创建流程

```
[开始] 
   ↓
[选择创建方式]
   ├─ 从头创建
   ├─ 使用模板
   └─ 从学习路径创建
   ↓
[步骤1: 基础配置]
 - 填写标题、课程信息
   ↓
[步骤2: 智能配置]
 - 选择知识点
 - 配置教学参数
   ↓
[步骤3: AI生成]
 - 显示生成进度
 - 显示生成提示
   ↓
[生成完成]
   ↓
[进入编辑器]
 - 可视化编辑
 - 实时预览
   ↓
[保存或导出]
 - 保存草稿
 - 发布教案
 - 导出文档
   ↓
[完成]
```

### 教案编辑流程

```
[教案列表]
   ↓
[点击编辑]
   ↓
[加载教案数据]
   ↓
[进入编辑器]
 - 左侧编辑区
 - 右侧预览区
   ↓
[编辑内容]
 - 文本编辑
 - 格式调整
 - AI辅助
   ↓
[实时预览更新]
   ↓
[保存修改]
 - 自动保存草稿(每30秒)
 - 手动保存
   ↓
[发布或导出]
   ↓
[完成]
```

### 教案导出流程

```
[选择导出格式]
   ├─ Word
   ├─ PPT
   └─ PDF
   ↓
[选择导出模板]
 - 模板样式选择
   ↓
[开始导出]
 - 显示导出进度
   ↓
[生成文档]
 - 渲染内容
 - 应用样式
   ↓
[下载文档]
   ↓
[导出成功提示]
```

## 界面设计要点

### 1. 教案创建页

**页面布局**
- 顶部:步骤指示器,显示当前进度
- 中间:表单内容区,每一步的配置项
- 底部:操作按钮(上一步/下一步/生成)

**交互细节**
- 步骤指示器点击可跳转到对应步骤
- 表单验证,必填项未填写时禁用下一步按钮
- AI生成时显示加载动画和生成提示
- 生成失败时显示错误信息,允许重试

### 2. 可视化编辑器

**页面布局**
- 顶部工具栏:格式化按钮、保存、导出等操作
- 左侧编辑区(60%宽度):
  - 模块导航(可折叠)
  - 富文本编辑区域
- 右侧预览区(40%宽度):
  - 实时渲染的教案内容
  - 支持切换预览模式(网页/Word/PPT)
- 底部状态栏:自动保存状态、字数统计

**交互细节**
- 编辑区和预览区同步滚动
- 点击预览区可定位到对应编辑位置
- 模块支持拖拽排序
- AI辅助功能悬浮在编辑区右侧
- 快捷键支持(Ctrl+S保存、Ctrl+B加粗等)

### 3. 教案列表页

**页面布局**
- 顶部:标题、创建按钮、搜索框、筛选器
- 中间:教案卡片列表或表格视图
- 底部:分页器

**卡片视图设计**
每个教案卡片包含:
- 教案标题(大字)
- 课程名称、作者
- 创建时间、修改时间
- 状态标签(草稿/已发布)
- 操作按钮(查看/编辑/导出/删除)

**交互细节**
- 卡片悬浮时显示更多操作按钮
- 支持卡片视图和列表视图切换
- 支持多选和批量操作
- 快捷操作:点击标题查看详情,点击编辑按钮进入编辑

### 4. 教案详情页

**页面布局**
- 顶部:教案标题、操作按钮
- 中间:教案内容分模块展示
- 右侧:基本信息卡片(固定)

**内容展示**
- 按模块分段展示,每个模块可折叠
- 重点内容高亮显示
- 表格和列表美化展示

**交互细节**
- 点击编辑按钮进入编辑器
- 导出按钮弹出格式选择菜单
- 分享按钮生成分享链接并复制
- 支持打印预览

## 技术实现要点

### 1. 富文本编辑器选型

建议使用成熟的富文本编辑器库:

**候选方案**
- TipTap:基于ProseMirror,现代化、可扩展性强
- Quill:轻量级,功能完善
- Slate:完全可定制,React友好

**推荐方案:TipTap**
- 基于React开发,与项目技术栈匹配
- 模块化设计,易于扩展
- 支持协同编辑(未来可扩展)
- 丰富的插件生态

**核心扩展**
- 基础格式化(Bold, Italic, Underline等)
- 标题层级(Heading)
- 列表(BulletList, OrderedList)
- 表格(Table)
- 图片上传
- 自定义模块组件

### 2. 实时预览实现

**方案一:HTML模板渲染**
- 将编辑器内容转换为HTML
- 应用预设的CSS样式
- 实时渲染到预览区

**方案二:基于组件的渲染**
- 将编辑内容解析为React组件
- 动态渲染组件树
- 支持样式主题切换

**推荐:方案一(简单高效)**

### 3. 文档导出实现

**Word导出**
- 使用docx库生成.docx文件
- 优化:
  - 预定义样式模板
  - 支持表格、图片等元素
  - 正确处理中文字体

**PPT导出**
- 使用pptxgenjs库生成.pptx文件
- 优化:
  - 预定义多种主题模板
  - 智能分页(内容过多自动分页)
  - 布局优化

**PDF导出**
- 方案一:使用jsPDF库直接生成PDF
- 方案二:先导出Word,再转PDF(需要后端支持)
- 推荐:方案一(前端实现,无需后端)

### 4. 自动保存机制

**实现策略**
- 防抖处理:用户停止编辑30秒后自动保存
- 定时保存:每3分钟自动保存一次
- 手动保存:点击保存按钮立即保存
- 离开页面前保存:监听beforeunload事件

**数据持久化**
- 使用localStorage作为临时存储(防止意外关闭)
- 定期同步到后端数据库
- 版本控制:保存历史版本,支持回退

### 5. AI生成优化

**内容质量提升**
- 优化Prompt工程:根据参数动态构建Prompt
- 引入示例库:提供高质量教案示例供AI参考
- 分步生成:先生成大纲,再逐模块生成详细内容
- 后处理优化:对生成内容进行格式化和优化

**生成速度优化**
- 并行生成:多个模块并行请求AI
- 流式输出:支持流式返回,逐步展示生成内容
- 缓存机制:相似配置的教案复用部分内容

### 6. 模板管理

**模板存储**
- 官方模板:存储在配置文件或数据库
- 个人模板:存储在用户数据库

**模板应用**
- 深拷贝模板数据
- 替换可变部分(标题、知识点等)
- 保留结构和样式

### 7. 性能优化

**编辑器性能**
- 虚拟滚动:处理超长文档
- 懒加载模块:按需加载编辑器功能
- 防抖和节流:优化输入事件处理

**渲染性能**
- 使用React.memo避免不必要的重渲染
- 代码分割:按路由拆分代码
- 图片懒加载

## 用户体验优化

### 1. 引导与帮助

**新手引导**
- 首次使用时展示引导弹窗
- 介绍主要功能和操作流程
- 提供快速入门教程

**操作提示**
- 重要操作前显示确认提示
- 操作成功/失败后给出明确反馈
- 关键字段提供tooltip说明

**帮助文档**
- 提供详细的帮助文档入口
- 常见问题FAQ
- 视频教程

### 2. 错误处理

**表单验证**
- 实时验证,即时反馈错误
- 明确的错误提示信息
- 高亮错误字段

**异常处理**
- 网络错误时显示友好提示,提供重试按钮
- AI生成失败时提供降级方案(使用模板)
- 导出失败时提示检查数据或联系支持

### 3. 快捷操作

**键盘快捷键**
- Ctrl+S:保存
- Ctrl+B:加粗
- Ctrl+I:斜体
- Ctrl+Z:撤销
- Ctrl+Y:重做
- Ctrl+F:查找

**右键菜单**
- 选中文本右键:复制、粘贴、格式化、AI辅助

**快捷面板**
- 常用模块快速插入
- 最近使用的操作

### 4. 响应式设计

虽然主要面向PC端使用,但应考虑:
- 平板设备适配
- 编辑器在小屏幕上的布局调整
- 移动端查看教案的体验优化

## 测试要点

### 1. 功能测试

- 教案创建流程各步骤功能正常
- 知识点选择、搜索、筛选功能正常
- AI生成内容质量符合预期
- 编辑器各功能按钮工作正常
- 实时预览准确无误
- 导出Word/PPT/PDF格式正确
- 教案列表展示、搜索、筛选、排序功能正常
- 教案详情页展示正确
- 模板应用功能正常
- 分享功能正常

### 2. 性能测试

- 大量教案数据下列表加载速度
- 编辑器处理长文档的性能
- AI生成响应时间
- 文档导出速度
- 自动保存不影响编辑体验

### 3. 兼容性测试

- Chrome、Edge、Safari、Firefox等主流浏览器
- 不同操作系统(Windows、macOS)
- 导出文档在Office、WPS等软件中打开正常

### 4. 用户体验测试

- 操作流程是否流畅
- 提示信息是否清晰
- 错误处理是否友好
- 加载状态是否明确
- 整体视觉风格是否统一

## 迭代规划

### 第一阶段:基础功能(MVP)

- 教案创建3步流程
- 基础AI生成引擎
- 简单的在线编辑功能
- Word导出
- 教案列表管理

### 第二阶段:编辑器增强

- 富文本编辑器完整功能
- 实时预览
- 模块化编辑
- 自动保存
- PPT导出

### 第三阶段:AI能力提升

- AI辅助编辑(续写、润色、扩展)
- 智能推荐
- 教案质量评估
- 多种生成模板

### 第四阶段:协作与分享

- 教案分享
- 模板库
- 评论与评分
- 协作编辑(未来扩展)

## 成功指标

### 功能完整性

- 所有核心功能正常可用
- 导出文档格式正确,排版美观
- AI生成内容质量达到可用水平

### 用户体验

- 教案创建完成率 > 80%
- 用户满意度评分 > 4.0/5.0
- 平均创建时间 < 15分钟

### 性能指标

- 页面加载时间 < 2秒
- AI生成响应时间 < 10秒
- 文档导出时间 < 5秒

### 使用数据

- 月活跃用户数
- 教案创建数量
- 导出使用次数
- 模板使用次数
